(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cde4ba66"],{"1bc5":function(e,t,a){"use strict";var s=a("d839"),r=a.n(s);r.a},"65f0f":function(e,t,a){"use strict";var s=a("9c8e"),r=a.n(s);r.a},"80c1":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("common-layout",[s("div",{staticClass:"top"},[s("div",{staticClass:"header"},[s("img",{staticClass:"logo",attrs:{alt:"logo",src:a("4ffd")}}),s("span",{staticClass:"title"},[e._v(e._s(e.systemName))])])]),s("div",{staticClass:"login"},[s("a-form",{attrs:{form:e.form},on:{submit:e.onSubmit}},[s("a-tabs",{staticStyle:{padding:"0 2px"},attrs:{size:"large","tab-bar-style":{textAlign:"center"}}},[s("a-tab-pane",{key:"1",attrs:{tab:"账户密码登录"}},[e.error?s("a-alert",{staticStyle:{"margin-bottom":"24px"},attrs:{type:"error",closable:!0,message:e.error,"show-icon":""},on:{close:e.onClose}}):e._e(),s("a-form-item",[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入账户名",whitespace:!0}]}],expression:"['name', {rules: [{ required: true, message: '请输入账户名', whitespace: true}]}]"}],attrs:{autocomplete:"autocomplete",size:"large",placeholder:"请输入账户名"}},[s("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),s("a-form-item",[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"请输入密码",whitespace:!0}]}],expression:"['password', {rules: [{ required: true, message: '请输入密码', whitespace: true}]}]"}],attrs:{size:"large",placeholder:"请输入密码",autocomplete:"autocomplete",type:"password"}},[s("a-icon",{attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1)],1)],1),s("div",[s("a-checkbox",{attrs:{checked:!0}},[e._v("自动登录")]),s("a",{staticStyle:{float:"right"},on:{click:function(t){e.resetPasswordVisible=!0}}},[e._v("重置密码")])],1),s("a-form-item",[s("a-button",{staticStyle:{width:"100%","margin-top":"24px"},attrs:{loading:e.logging,size:"large","html-type":"submit",type:"primary"}},[e._v("登录")])],1)],1)],1),s("a-modal",{ref:"resetPasswordModal",attrs:{title:"重置密码",visible:e.resetPasswordVisible,"confirm-loading":e.confirmLoading},on:{ok:e.resetPassword,cancel:function(t){e.resetPasswordVisible=!1}}},[s("a-form",{ref:"resetPassForm",attrs:{form:e.resetPassForm,layout:"horizontal","label-align":"left","label-col":{span:5},"wrapper-col":{span:19}}},[s("a-form-item",{attrs:{label:"用户名称"}},[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["userName",{rules:[{required:!0,message:"请输入用户名称",whitespace:!0},e.inputLenRule,e.patternRule]}],expression:"['userName', {rules: [{ required: true, message: '请输入用户名称', whitespace: true},inputLenRule,patternRule]}]"}],attrs:{placeholder:"请输入用户名称"}})],1)],1)],1)],1)},r=[],o=(a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("5530")),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-layout"},[a("div",{staticClass:"content"},[e._t("default")],2),a("page-footer",{attrs:{"link-list":e.footerLinks,copyright:e.copyright,"copyright-link":e.copyrightLink}})],1)},n=[],c=a("613e"),l=a("5880"),m={name:"CommonLayout",components:{PageFooter:c["a"]},computed:Object(o["a"])({},Object(l["mapState"])("setting",["footerLinks","copyright","copyrightLink"]))},u=m,d=(a("65f0f"),a("0c7c")),p=Object(d["a"])(u,i,n,!1,null,"198e7ae6",null),f=p.exports,g=a("93d6"),h=a("b775"),b=a("89a5"),w=a("dde5"),v={name:"Login",components:{CommonLayout:f},data:function(){return{logging:!1,error:"",form:this.$form.createForm(this),resetPasswordVisible:!1,confirmLoading:!1,resetPassForm:this.$form.createForm(this),inputLenRule:{max:16,message:"最长可输入16位"},patternRule:{pattern:new RegExp(/^\w+$/,"g"),message:"只能输入数字、字母、下划线"}}},computed:{systemName:function(){return this.$store.state.setting.systemName}},methods:Object(o["a"])(Object(o["a"])({},Object(l["mapMutations"])("account",["setUser","setPermissions","setRoles"])),{},{resetPassword:function(){var e=this;this.resetPassForm.validateFields((function(t){if(!t){var a=e.resetPassForm.getFieldValue("userName");e.confirmLoading=!0,w["d"].resetPassword(a).then((function(t){"success"===t.data?(e.$message.success("重置成功!"),e.resetPasswordVisible=!1):e.$message.error("重置密码失败!不存在该用户")})).catch((function(e){})).finally((function(){e.confirmLoading=!1}))}}))},onSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e){if(!e){t.logging=!0;var a=t.form.getFieldValue("name"),s=t.form.getFieldValue("password");Object(g["c"])(a,t.$encrypt(s)).then(t.afterLogin).catch((function(e){}))}}))},afterLogin:function(e){this.logging=!1;var t=e.data,a={NO_USER:"ename",ERR_PASS:"epass",SUCCESS:"success"},s=[{id:"queryForm",operation:["add","edit"]}],r=[{id:"admin",operation:["add","edit","delete"]}],o="Authorization:"+Math.random(),i=new Date((new Date).getTime()+864e5);switch(t){case a.NO_USER:this.error="用户不存在!";break;case a.ERR_PASS:this.error="密码错误!";break;case a.SUCCESS:this.setUser({name:e.config.params.n,avatar:"https://gw.alipayobjects.com/zos/rmsportal/cnrhVkzwxjPwAaCfPbdc.png"}),this.setPermissions(s),this.setRoles(r),Object(h["e"])({token:o,expireAt:new Date(i)}),this.$router.push("/home"),this.$message.success("登录成功!",3);break;default:this.error="unknown error!";break}},getRoutes:function(){Object(g["b"])().then((function(e){var t=e.data.data;Object(b["d"])(t)}))},onClose:function(){this.error=!1}})},y=v,k=(a("1bc5"),Object(d["a"])(y,s,r,!1,null,"3c6a6c8e",null)),P=k.exports;t["default"]=P},"9c8e":function(e,t,a){},d839:function(e,t,a){}}]);